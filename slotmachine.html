<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css" integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous">


    <style>
      /* .container{
        background-color: gray;
      } */
      [box-id] {
        width: 80px;
        height: 80px;
        display: flex;
        justify-content: center;
        align-items: center;
        border: none;
        /* border:  solid 5px black; */
        transition: .3s;
      }
      
      [box-id].active {
        border: solid 5px  red;
        box-shadow: 0 0 20px red;
        transition:  0s;
      }

      i {
        font-size: 48px;
      }

      #msg {
        font-size: 36px;
        text-align: center;
      }

      button {
         /* border-radius: 35px; */
         border: none;
         background-color: white;
      }

      .badge badge-pill badge-primary {
         width: 100%;
      }

      .title {
         text-align: center;
         margin: 35px;
      }

    </style>

    <title>Hello, world!</title>
  </head>
  <body>

   <div class="title">
      <h2>新人驚喜紅包</h2>
      <h3>恭喜你獲得0次抽獎機會</h3>
   </div>
   

   <!-- <span class="badge badge-pill badge-primary">恭喜你獲得一次抽獎機會</span> -->

    <div class="container">
      
      <div class="row row-cols-12">
        <div box-id="1" class="col"></div>
        <!-- <div box-id="2" class="col"></div>
        <div box-id="3" class="col"></div>
        <div box-id="4" class="col"></div>
        <div box-id="5" class="col"></div> -->
        <div box-id="6" class="col"></div>
        <!-- <div box-id="7" class="col"></div>
        <div box-id="8" class="col"></div>
        <div box-id="9" class="col"></div>
        <div box-id="10" class="col"></div>
        <div box-id="11" class="col"></div> -->
        <div box-id="12" class="col"></div>
      </div>
      <!-- <div class="row row-cols-12"> -->
        <!-- <div box-id="32" class="col"></div> -->
        <!-- <div class="col-10"></div> -->
        <!-- <div box-id="13" class="col"></div> -->
      <!-- </div> -->
      <!-- <div class="row row-cols-12"> -->
        <!-- <div box-id="31" class="col"></div> -->
        <!-- <div class="col-10"></div> -->
        <!-- <div class="col-10 m-auto"> -->
         
        <!-- </div> -->
        <!-- <div box-id="14" class="col"></div> -->
      <!-- </div> -->
      <div class="row row-cols-12">
        <div box-id="30" class="col"></div>
        <!-- <div class="col-4 cols-4">
         <i class="fas fa-coins"></i>
        </div> -->
        <button type="button" class="col-4 cols-4" >
         <!-- <div class=" col-4 cols-4"> -->
         <i class="fas fa-coins"></i>
        <!-- </div> -->
         </button>
        <div box-id="15" class="col"></div>
      </div>
      <!-- <div class="row row-cols-12"> -->
        <!-- <div box-id="29" class="col"></div> -->
        <!-- <div class="col-10"></div> -->
        <!-- <div box-id="16" class="col"></div> -->
      <!-- </div> -->
      <div class="row row-cols-12">
        <div box-id="28" class="col"></div>
        <!-- <div box-id="27" class="col"></div>
        <div box-id="26" class="col"></div>
        <div box-id="25" class="col"></div>
        <div box-id="24" class="col"></div> -->
        <div box-id="23" class="col"></div>
        <!-- <div box-id="22" class="col"></div>
        <div box-id="21" class="col"></div>
        <div box-id="20" class="col"></div>
        <div box-id="19" class="col"></div>
        <div box-id="18" class="col"></div> -->
        <div box-id="17" class="col"></div>
      </div>
      

      <!-- <button type="button" class="btn btn-primary btn-lg">Large button</button> -->
      <button type="button" class="btn btn-primary btn-lg btn-block" id="btnStart">開始抽獎</button>
      <p id="msg" class="m-0"></p>
     
    </div>



    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>


    <script>
      let brickData = [
        {
           id: '1',
           color:'green',
           icon: 'far fa-laugh',
           content: '1-謝謝參與',
         
           target: function(){
                return this.content.split('-')[1];
           }
        },
        {
           id: '2',
           color:'red',
           icon: 'fas fa-gift',
           content: '2-商城折價券50000元',
           target: function(){
                return this.content.split('-')[1];
           }
        },
        {
           id: '3',
           color:'green',
           content: '3-謝謝參與',
         icon: 'far fa-laugh',
           target: function(){
                return this.content.split('-')[1];
           }
        },
        {
           id: '4',
           color:'red',
           icon: 'fas fa-gift',
           content: '4-商城折價券100000元',
           target: function(){
                return this.content.split('-')[1];
           }
        },
        {
           id: '5',
           color:'green',
           content: '5-謝謝參與',
         icon: 'far fa-laugh',
           target: function(){
                return this.content.split('-')[1];
           }
        },
        {
           id: '6',
           color:'red',
           icon: 'fas fa-gift',
           content: '6-商城折價券66666元',
           target: function(){
                return this.content.split('-')[1];
           }
        },
        {
           id: '7',
           color:'green',
           content: '7-謝謝參與',
         icon: 'far fa-laugh',
           target: function(){
                return this.content.split('-')[1];
           }
        },
        {
           id: '8',
           color:'red',
           icon: 'fas fa-gift',
           content: '2-台積電股票~~',
           target: function(){
                return this.content.split('-')[1];
           }
        },
        {
           id: '9',
           color:'green',
           icon: 'fab fa-line',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '10',
           color:'red',
           icon: 'fab fa-instagram-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '11',
           color:'blue',
           icon: 'fab fa-facebook-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '12',
           color:'green',
           icon: 'fab fa-line',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '13',
           color:'red',
           icon: 'fab fa-instagram-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '14',
           color:'blue',
           icon: 'fab fa-facebook-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '15',
           color:'green',
           icon: 'fab fa-line',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '16',
           color:'red',
           icon: 'fab fa-instagram-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '17',
           color:'blue',
           icon: 'fab fa-facebook-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '18',
           color:'green',
           icon: 'fab fa-line',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '19',
           color:'red',
           icon: 'fab fa-instagram-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '20',
           color:'blue',
           icon: 'fab fa-facebook-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '21',
           color:'green',
           icon: 'fab fa-line',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '22',
           color:'red',
           icon: 'fab fa-instagram-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '23',
           color:'blue',
           icon: 'fab fa-facebook-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '24',
           color:'green',
           icon: 'fab fa-line',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '25',
           color:'red',
           icon: 'fab fa-instagram-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '26',
           color:'blue',
           icon: 'fab fa-facebook-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '27',
           color:'green',
           icon: 'fab fa-line',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '28',
           color:'red',
           icon: 'fab fa-instagram-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '29',
           color:'blue',
           icon: 'fab fa-facebook-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '30',
           color:'green',
           icon: 'fab fa-line',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '31',
           color:'red',
           icon: 'fab fa-instagram-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        {
           id: '32',
           color:'blue',
           icon: 'fab fa-facebook-square',
           target: function(){
                return this.icon.split('-')[1];
           }
        },
        // {
        //    id: '33',
        //    color:'green',
        //    icon: 'fab fa-line',
        //    target: function(){
        //         return this.icon.split('-')[1];
        //    }
        // },
      ]

      let steps = 0;  //剩餘的步數
      let allSteps = 0; //余部的不樹
      let current = 0;  //目前走到哪一格
      let speed;  //速率(越大代表越慢)

      //喧染畫面
      let bricks = document.querySelectorAll('[box-id]');
      bricks = Array.from(bricks).sort((a, b) => {
        return a.getAttributeNode('box-id').value - b.getAttributeNode('box-id').value;
      });
      bricks.forEach((x, index) =>{
          let id = index + 1;
          let data = brickData.find(x => x.id == id);
          let icon = document.createElement('i');
          icon.setAttribute('class', data.icon);
          icon.style.color = data.color;
          x.appendChild(icon);
      });

      //start Button
      document.querySelector('#btnStart').addEventListener('click', function(){
          speed=50;

          let random = Math.floor(Math.random() * brickData.length) + 1;
          steps = random + (3 * brickData.length);
          allSteps = steps;
          turnAround();
      });

      function turnAround() {
        bricks[current].classList.remove('active');
        current++;

        if(current >= bricks.length) current = 0;

        bricks[current].classList.add('active');
        steps--;

        // if(steps > 0){
        //   //還沒跑完
        //   setTimeout(turnAround, speed);
        // }else {
        //   //跑完
        //   // console.log(`跑完了 ${brickData[current].target()}`)
        //   let msgBox = document.querySelector('#msg');
        //   let val = brickData[current].target();
        //   msgBox.innerText = `接下來30分 -> ${val}`;
        // }
        
        //變速版本
        if (steps > 0) {
          setTimeout(turnAround, speed);

          if(steps < Math.floor((allSteps / 3))) speed +=7;
        }else {
          let msgBox = document.querySelector('#msg');
          let val = brickData[current].target();
          msgBox.innerText = `${val}`;
        }

        
        // console.log(steps);
      }

    </script>


  
  
  </body>
</html>